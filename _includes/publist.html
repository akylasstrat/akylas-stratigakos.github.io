{%- comment -%}
Parameters:
  type: "journal" | "conference" | "preprint"
  limit: optional number (e.g., 5)
  hide_years: "true" to suppress year headings (nice for homepage snippets)
{%- endcomment -%}

{%- assign items = site.data.publications | where: "type", include.type | sort: "year" | reverse -%}
{%- if include.limit %}{% assign items = items | slice: 0, include.limit %}{% endif -%}

{%- if items.size == 0 -%}
<p>No entries yet.</p>
{%- elsif include.hide_years == "true" -%}
<ul class="pubs">
  {%- for p in items -%}
  <li class="pub">
    {{ p.authors }}.
    <strong>{{ p.title }}</strong>.
    <em>{{ p.venue }}</em>, {{ p.year }}.
    {%- if p.pdf %} [<a href="{{ p.pdf | relative_url }}">PDF</a>]{% endif -%}
    {%- if p.doi %} [<a href="https://doi.org/{{ p.doi }}">DOI</a>]{% endif -%}
    {%- if p.url and not p.doi %} [<a href="{{ p.url }}">Link</a>]{% endif -%}
    {%- if p.code %} [<a href="{{ p.code }}">Code</a>]{% endif -%}
  </li>
  {%- endfor -%}
</ul>
{%- else -%}
{%- assign years = items | map: "year" | uniq -%}
{%- for y in years -%}
### {{ y }}
<ul class="pubs">
  {%- for p in items -%}{% if p.year == y -%}
  <li class="pub">
    {{ p.authors }}.
    <strong>{{ p.title }}</strong>.
    <em>{{ p.venue }}</em>.
    {%- if p.pdf %} [<a href="{{ p.pdf | relative_url }}">PDF</a>]{% endif -%}
    {%- if p.doi %} [<a href="https://doi.org/{{ p.doi }}">DOI</a>]{% endif -%}
    {%- if p.url and not p.doi %} [<a href="{{ p.url }}">Link</a>]{% endif -%}
    {%- if p.code %} [<a href="{{ p.code }}">Code</a>]{% endif -%}
  </li>
  {%- endif -%}{% endfor -%}
</ul>
{%- endfor -%}
{%- endif -%}
